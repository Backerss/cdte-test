<%
  // Use server-provided evaluation practice history. Server should pass `evaluationPracticeHistory` and optionally `activeEvalPeriodId`.
  const evalPractice = (typeof evaluationPracticeHistory !== 'undefined' && Array.isArray(evaluationPracticeHistory))
    ? evaluationPracticeHistory
    : [];

  const activeEvalPeriod = (typeof activeEvalPeriodId !== 'undefined')
    ? evalPractice.find(p => p.id === activeEvalPeriodId)
    : evalPractice.find(p => p.status === 'active');

  const currentEvalData = activeEvalPeriod || (evalPractice.length > 0 ? evalPractice[evalPractice.length - 1] : null);
  const userYear = user.year || 3;

  const hasPractice = evalPractice.length > 0;
  const hasActive = !!activeEvalPeriod;

  // Check if user is pure admin (admin role without student ID)
  const isPureAdmin = user && user.role === 'admin' && !user.studentId;
%>

<div class="page-content">
  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px;gap:16px;flex-wrap:wrap">
      <div>
        <h2 style="margin:0 0 8px 0;color:var(--color-primary);display:flex;align-items:center;gap:12px">
          <span>üìù</span>
          ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô
        </h2>
        <p class="text-muted" style="margin:0">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ù‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏Ñ‡∏£‡∏π</p>
      </div>
      
      <div class="form-group" style="margin:0;min-width:300px">
        <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏ß‡∏î‡∏ù‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå</label>
        <select id="evalPeriodSelector" class="form-input" onchange="changeEvalPeriod()" style="padding:10px 14px">
          <% if (!hasPractice) { %>
            <option value="none" selected disabled>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏ß‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå</option>
          <% } else { %>
            <% evalPractice.slice().reverse().forEach((record) => { %>
              <option value="<%= record.id %>" <%= record.status === 'active' ? 'selected' : '' %>>
                <%= record.period %> (‡∏õ‡∏µ <%= record.year %>)
                <%= record.status === 'active' ? ' - ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' : '' %>
              </option>
            <% }); %>
          <% } %>
        </select>
      </div>
    </div>

    <% if (isPureAdmin) { %>
      <div style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
          <span style="font-size: 1.5rem;">üîí</span>
          <h3 style="margin: 0; font-size: 1.2rem;">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</h3>
        </div>
        <p style="margin: 0; font-size: 1rem; line-height: 1.5; opacity: 0.95;">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞ <strong>‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</strong> ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ<br>‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
      </div>
    <% } else if (!hasActive) { %>
      <div id="noEvalActiveBanner" style="background:#fff3cd;border-left:4px solid #ffc107;padding:12px;border-radius:8px;margin-bottom:16px;color:#856404">
        ‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏ß‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô "‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô" ‚Äî ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ß‡∏î‡∏ù‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
      </div>
    <% } %>

    <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤ (Read-only) -->
    <div id="evalHistoryView" style="display:none">
      <div style="background:rgba(251,180,37,0.1);border-left:4px solid var(--color-secondary);padding:16px;border-radius:8px;margin-bottom:24px">
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
          <span style="font-size:1.3rem">üìö</span>
          <strong style="color:var(--color-text);font-size:1.1rem">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á (Read-Only)</strong>
        </div>
        <p style="margin:0;color:var(--color-muted);font-size:0.9rem">
          ‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏á‡∏ß‡∏î‡∏ù‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ
        </p>
      </div>
      <div id="evalHistoryContent"></div>
    </div>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏ß‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Editable) -->
    <% if (!isPureAdmin) { %>
    <div id="evalCurrentContent">
        <!-- Practice Period Info -->
        <div class="info-banner" style="background:var(--color-bg);border-left:4px solid var(--color-primary);padding:16px;border-radius:8px;margin-bottom:24px">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
          <span style="font-size:1.5rem">üìÖ</span>
          <div>
            <strong style="color:var(--color-text)">‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå:</strong>
            <span id="practiceRange">-</span>
          </div>
        </div>
        <div style="margin:8px 0 0 44px;font-size:0.9rem;color:var(--color-muted)">
          <strong style="color:var(--color-text)">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà <%= userYear %>:</strong>
          <% if (userYear <= 3) { %>
            <span>‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô <strong>9 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong> (3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå √ó 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</span>
          <% } else { %>
            <span style="color:var(--color-success)">‚úÖ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏õ‡∏µ 4 ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô)</span>
          <% } %>
        </div>
        <% if (userYear <= 3) { %>
          <p style="margin:8px 0 0 44px;font-size:0.9rem;color:var(--color-muted)">
            * ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ù‡∏∂‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏ô‡∏¥‡πÄ‡∏ó‡∏®
          </p>
        <% } %>
      </div>

      <!-- Lesson Plan Upload Section (Separate Task) -->
      <!-- ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏µ 2-3 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ -->
      <!-- ‡∏õ‡∏µ 1: ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏™‡∏≠‡∏ô‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô) -->
      <!-- ‡∏õ‡∏µ 2-3: ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ (‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏™‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á) -->
      <!-- ‡∏õ‡∏µ 4: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô (‡∏ù‡∏∂‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏ß‡∏•‡∏≤) -->
      <% if (userYear >= 2 && userYear <= 3) { %>
      <div class="card" style="margin-bottom:24px;background:var(--color-bg);border:2px dashed var(--color-primary)">
        <h3 style="color:var(--color-primary);margin:0 0 16px 0;display:flex;align-items:center;gap:12px">
          <span>üìã</span>
          ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
          <span style="background:var(--color-warning);color:white;font-size:0.75rem;padding:4px 12px;border-radius:12px;font-weight:600">‡∏á‡∏≤‡∏ô‡πÅ‡∏¢‡∏Å</span>
        </h3>
        <p style="margin:0 0 16px 0;color:var(--color-muted)">
          ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà <%= userYear %> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
        </p>

      <!-- Lesson Plan Upload UI -->
      <div style="background:white;padding:20px;border-radius:8px;border:1px solid var(--color-border)">
        <div style="display:flex;gap:12px;align-items:center;margin-bottom:16px">
          <input type="file" id="mainLessonPlanInput" accept=".pdf,.doc,.docx,.ppt,.pptx" style="display:none">
          <button type="button" class="btn btn--primary" onclick="document.getElementById('mainLessonPlanInput').click()" style="display:flex;align-items:center;gap:8px">
            <span>üìé</span>
            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
          </button>
          <span id="mainLessonPlanFileName" style="color:var(--color-muted);font-size:0.9rem">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</span>
        </div>

        <div id="mainLessonPlanPreview" style="display:none;background:var(--color-bg);padding:16px;border-radius:8px;border:1px solid var(--color-border)">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <strong style="color:var(--color-text)">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå:</strong>
            <button type="button" class="btn btn--danger btn--icon" onclick="removeMainLessonPlan()" title="‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå">
              üóëÔ∏è
            </button>
          </div>
          <div id="mainLessonPlanPreviewContent"></div>
        </div>

        <div style="margin-top:16px;text-align:right">
          <button type="button" class="btn btn--success" onclick="submitLessonPlan()" id="submitLessonPlanBtn" disabled style="display:flex;align-items:center;gap:8px;margin-left:auto">
            <span>üì§</span>
            ‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
          </button>
        </div>
      </div>
      
        <!-- Lesson Plan Status -->
        <div id="lessonPlanStatus" style="margin-top:16px;padding:12px;border-radius:8px;background:#fff3cd;color:#856404;display:none">
          <div style="display:flex;align-items:center;gap:8px">
            <span>üìã</span>
            <span id="lessonPlanStatusText">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</span>
          </div>
        </div>
      </div>
      <% } %>

      <!-- Evaluation Grid: 3 weeks √ó 3 evaluations -->
      <% if (userYear <= 3) { %>
      <div style="margin-top:24px">
        <% for (let week = 1; week <= 3; week++) { %>
          <div class="eval-week-section" style="margin-bottom:32px">
            <h3 style="color:var(--color-primary);margin:0 0 16px 0;display:flex;align-items:center;gap:8px">
              <span>üìå</span>
              ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà <%= week %>
            </h3>
            
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px">
              <% for (let evalNum = 1; evalNum <= 3; evalNum++) { 
                 const globalNum = (week - 1) * 3 + evalNum;
              %>
                <div class="eval-card" data-eval="<%= globalNum %>">
                  <div class="eval-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                    <h4 style="margin:0;color:var(--color-text)">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà <%= globalNum %></h4>
                    <span class="eval-status pending" id="status-<%= globalNum %>">
                      <span class="status-icon">‚è≥</span>
                      <span class="status-text">‡∏£‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</span>
                    </span>
                  </div>
                  
                  <div class="eval-date" id="date-<%= globalNum %>" style="font-size:0.85rem;color:var(--color-muted);margin-bottom:12px">
                    ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span class="date-value">-</span>
                  </div>

                  <button class="btn btn--primary btn-eval" 
                          data-eval="<%= globalNum %>" 
                          onclick="startEvaluation(<%= globalNum %>)"
                          style="width:100%">
                    ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
                  </button>
                </div>
              <% } %>
            </div>
          </div>
        <% } %>
      </div>
      <% } else { %>
        <div style="text-align:center;padding:60px 20px;background:var(--color-bg);border-radius:12px;border:2px dashed var(--color-border)">
          <div style="font-size:4rem;margin-bottom:16px">üéì</div>
          <h3 style="color:var(--color-primary);margin:0 0 12px 0">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4 ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô</h3>
          <p style="color:var(--color-muted);margin:0">‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ù‡∏∂‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏ß‡∏•‡∏≤ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ</p>
        </div>
      <% } %>
    </div>
    <% } %>
  </div>
</div>

<!-- Evaluation Details Modal (Read-only) -->
<div id="evaluationDetailsModal" class="modal-overlay" style="display:none">
  <div class="modal-content" style="max-width:1000px;max-height:90vh">
    <div class="modal-header">
      <h3>üìä ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô - <span id="detailsEvalTitle">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 1</span></h3>
      <button type="button" class="modal-close" onclick="closeDetailsModal()">√ó</button>
    </div>
    
    <div class="modal-body" style="padding:24px">
      <div class="eval-info" style="background:var(--color-bg);padding:12px;border-radius:6px;margin-bottom:20px">
        <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:</strong> <span id="detailsEvalDate">-</span>
      </div>

      <div id="detailsContent"></div>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn--secondary" onclick="closeDetailsModal()">
        ‡∏õ‡∏¥‡∏î
      </button>
    </div>
  </div>
</div>

<!-- Evaluation Modal -->
<div id="evaluationModal" class="modal-overlay" style="display:none">
  <div class="modal-content" style="max-width:900px;max-height:90vh">
    <div class="modal-header">
      <h3>‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô - <span id="evalTitle">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 1</span></h3>
      <button type="button" class="modal-close" onclick="closeEvaluationModal()">√ó</button>
    </div>
    
    <div class="modal-body" style="padding:24px">
      <div class="eval-info" style="background:var(--color-bg);padding:12px;border-radius:6px;margin-bottom:20px">
        <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:</strong> <span id="modalEvalDate">-</span>
      </div>

      <form id="evaluationForm">
        <!-- Teacher Verbal Behaviors -->
        <div class="eval-section">
          <h4 class="section-title">‡∏Ñ‡∏£‡∏π - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏≤ (Verbal Behaviors)</h4>
          <div class="question-list">
            <div class="question-item">
              <label class="question-label">1. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Å‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏ï‡∏•‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q1" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">2. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏Å‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏ï‡∏•‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q2" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">3. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏Å‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏ï‡∏•‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q3" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">4. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ß‡πà‡∏≤‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏ï‡∏•‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q4" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>
          </div>
        </div>

        <!-- Teacher Non-Verbal Behaviors -->
        <div class="eval-section">
          <h4 class="section-title">‡∏Ñ‡∏£‡∏π - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏†‡∏≤‡∏©‡∏≤ (Non-Verbal Behavior)</h4>
          <div class="question-list">
            <div class="question-item">
              <label class="question-label">5. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏á‡∏µ‡∏¢‡∏ö</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q5" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">6. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡πâ‡∏° ‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q6" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">7. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q7" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">8. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q8" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">9. ‡∏Ñ‡∏£‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô/ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î/ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q9" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>
          </div>
        </div>

        <!-- Student Academic Behaviors -->
        <div class="eval-section">
          <h4 class="section-title">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
          <div class="question-list">
            <div class="question-item">
              <label class="question-label">1. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡πà‡∏á‡∏°‡∏≠‡∏á‡πÉ‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q10" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">2. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q11" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">3. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q12" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">4. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡πà‡∏á‡∏°‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q13" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">5. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q14" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">6. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏π‡∏™‡∏≠‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q15" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>
          </div>
        </div>

        <!-- Student Work Behaviors -->
        <div class="eval-section">
          <h4 class="section-title">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
          <div class="question-list">
            <div class="question-item">
              <label class="question-label">1. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q16" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">2. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q17" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">3. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q18" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>
          </div>
        </div>

        <!-- Learning Environment -->
        <div class="eval-section">
          <h4 class="section-title">‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ - ‡∏™‡∏†‡∏≤‡∏û‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
          <div class="question-list">
            <div class="question-item">
              <label class="question-label">1. ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏õ‡∏£‡∏Å</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q19" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">2. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≠‡∏û‡πà‡∏ß‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏õ‡πâ‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå ‡πÄ‡∏°‡∏≤‡∏™‡πå ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q20" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">3. ‡∏ù‡∏≤‡∏ú‡∏ô‡∏±‡∏á‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q21" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">4. ‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ 1 ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 1 ‡∏Ñ‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q22" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">5. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q23" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">6. ‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏≠‡∏â‡∏≤‡∏¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q24" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">7. ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏°‡∏µ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q25" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>

            <div class="question-item">
              <label class="question-label">8. ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏°‡∏µ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</label>
              <div class="rating-group">
                <% for (let i = 1; i <= 5; i++) { %>
                  <label class="rating-option">
                    <input type="radio" name="q26" value="<%= i %>" required>
                    <span><%= i %></span>
                  </label>
                <% } %>
              </div>
            </div>
          </div>
        </div>

        <div class="rating-legend" style="background:var(--color-bg);padding:12px;border-radius:6px;margin-top:24px;text-align:center">
          <strong>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</strong>
          <span style="margin-left:16px">1 = ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</span>
          <span style="margin-left:8px">|</span>
          <span style="margin-left:8px">2 = ‡∏û‡∏≠‡πÉ‡∏ä‡πâ</span>
          <span style="margin-left:8px">|</span>
          <span style="margin-left:8px">3 = ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
          <span style="margin-left:8px">|</span>
          <span style="margin-left:8px">4 = ‡∏î‡∏µ</span>
          <span style="margin-left:8px">|</span>
          <span style="margin-left:8px">5 = ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn--secondary" onclick="closeEvaluationModal()">
        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
      </button>
      <button type="button" class="btn btn--primary" onclick="submitEvaluation()">
        ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
      </button>
    </div>
  </div>
</div>

<link rel="stylesheet" href="/css/evaluation.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/observation-utils.js"></script>
<script>
// Expose server-side config to evaluation.js
window.evalPageConfig = {
  isPureAdmin: <%= isPureAdmin ? 'true' : 'false' %>,
  hasPractice: <%= hasPractice ? 'true' : 'false' %>,
  hasActive: <%= hasActive ? 'true' : 'false' %>,
  userYear: <%= userYear %>
};
</script>
<script src="/js/evaluation.js"></script>
