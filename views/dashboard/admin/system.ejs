<link rel="stylesheet" href="/css/system.css">

<div class="page-content">
  <div class="card">
    <div class="page-header">
      <div>
        <h2 style="margin-top:0;color:var(--color-primary);display:flex;align-items:center;gap:12px">
          <span>тЪЩя╕П</span>
          р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕гр╕░р╕Ър╕Ъ
        </h2>
        <p class="text-muted">р╕Др╕зр╕Ър╕Др╕╕р╕бр╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕зр╣Зр╕Ър╣Др╕Лр╕Хр╣М р╕Фр╕╣ Logs р╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕гр╕░р╕Ър╕Ър╕лр╕ер╕▒р╕Зр╕Ър╣Йр╕▓р╕Щ</p>
      </div>
      <div style="display:flex;gap:8px;">
        <button class="btn btn--secondary" onclick="refreshSystemData()">
          <span>ЁЯФД</span> р╕гр╕╡р╣Ар╕Яр╕гр╕К
        </button>
        <button class="btn btn--primary" onclick="openBackupModal()">
          <span>ЁЯТ╛</span> р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
        </button>
        <button class="btn btn--danger" onclick="openResetDatabaseModal()" style="background: var(--color-danger); color: white;">
          <span>ЁЯЧСя╕П</span> Reset Database
        </button>
      </div>
    </div>

    <!-- System Status Control -->
    <div class="system-section">
      <h3 class="section-title">
        <span>ЁЯМР</span> р╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕зр╣Зр╕Ър╣Др╕Лр╕Хр╣М
      </h3>

      <div class="status-control-grid">
        <div class="status-card active" id="statusOnline" onclick="setSystemStatus('online')">
          <div class="status-icon">тЬЕ</div>
          <div class="status-label">р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ</div>
          <div class="status-desc">р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Фр╣Йр╕Ыр╕Бр╕Хр╕┤</div>
        </div>

        <div class="status-card" id="statusMaintenance" onclick="setSystemStatus('maintenance')">
          <div class="status-icon">ЁЯФз</div>
          <div class="status-label">р╕Ър╕│р╕гр╕╕р╕Зр╕гр╕▒р╕Бр╕йр╕▓</div>
          <div class="status-desc">р╣Бр╕кр╕Фр╕Зр╕лр╕Щр╣Йр╕▓р╕Ыр╕┤р╕Фр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З</div>
        </div>

        <div class="status-card" id="statusOffline" onclick="setSystemStatus('offline')">
          <div class="status-icon">ЁЯЪл</div>
          <div class="status-label">р╕Ыр╕┤р╕Фр╕Кр╕▒р╣Ир╕зр╕Др╕гр╕▓р╕з</div>
          <div class="status-desc">р╕Ыр╕┤р╕Фр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф</div>
        </div>
      </div>

      <div class="status-message" id="statusMessage">
        <strong>р╕кр╕Цр╕▓р╕Щр╕░р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ:</strong> <span id="currentStatus">р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤</span>
        <span style="margin-left:16px;color:var(--color-muted)">р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕ер╣Ир╕▓р╕кр╕╕р╕Ф: <span id="lastUpdate">-</span></span>
      </div>
    </div>

    <!-- System Logs Viewer -->
    <div class="system-section">
      <h3 class="section-title">
        <span>ЁЯУЭ</span> System Logs
      </h3>

      <div class="logs-controls">
        <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
          <select id="logLevel" class="form-input" style="width:auto;min-width:120px;" onchange="filterLogs()">
            <option value="">р╕Чр╕╕р╕Бр╕гр╕░р╕Фр╕▒р╕Ъ</option>
            <option value="info">Info</option>
            <option value="warning">Warning</option>
            <option value="error">Error</option>
            <option value="debug">Debug</option>
          </select>

          <select id="logCategory" class="form-input" style="width:auto;min-width:150px;" onchange="filterLogs()">
            <option value="">р╕Чр╕╕р╕Бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И</option>
            <option value="auth">Authentication</option>
            <option value="database">Database</option>
            <option value="api">API</option>
            <option value="system">System</option>
          </select>

          <input type="text" id="logSearch" class="form-input" placeholder="р╕Др╣Йр╕Щр╕лр╕▓ logs..."
            style="flex:1;min-width:200px;" onkeyup="filterLogs()">

          <button class="btn btn--secondary" onclick="clearLogsDisplay()">
            <span>ЁЯЧСя╕П</span> р╕ер╣Йр╕▓р╕Зр╕лр╕Щр╣Йр╕▓р╕Ир╕н
          </button>

          <button class="btn btn--primary" onclick="exportLogs()">
            <span>ЁЯУе</span> Export
          </button>
        </div>

        <div class="logs-auto-refresh">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="autoRefresh" onchange="toggleAutoRefresh()" checked>
            <span>Auto-refresh (5s)</span>
          </label>
        </div>
      </div>

      <div class="logs-viewer" id="logsViewer">
        <div class="log-entry" style="text-align:center;padding:40px;color:var(--color-muted);">
          р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Ф logs...
        </div>
      </div>
    </div>

    <!-- Recent Activities -->
    <div class="system-section">
      <h3 class="section-title">
        <span>ЁЯХР</span> р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕ер╣Ир╕▓р╕кр╕╕р╕Ф (5 р╕гр╕▓р╕вр╕Бр╕▓р╕г)
      </h3>
      <p style="color: var(--color-muted); margin: 0 0 16px 0; font-size: 0.9rem;">ЁЯУЭ р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╕Бр╕гр╕░р╕Чр╕│р╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Бр╕ер╕░р╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕ер╕гр╕░р╕Ър╕Ъ</p>

      <div class="activity-list" id="activityList">
        <!-- Will be populated by JavaScript -->
      </div>
    </div>
  </div>
</div>

<!-- Backup Modal -->
<div id="backupModal" class="modal-overlay" style="display:none">
  <div class="modal-content" style="max-width:600px;">
    <div class="modal-header">
      <h3>ЁЯТ╛ р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╕░р╕Ър╕Ъ</h3>
      <button type="button" class="modal-close" onclick="closeBackupModal()">├Ч</button>
    </div>

    <div class="modal-body" style="padding:24px;">
      <div class="form-group">
        <label class="form-label">р╣Ар╕ер╕╖р╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕З</label>
        <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px;">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="backupDB" checked>
            <span>ЁЯЧДя╕П р╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е</span>
          </label>
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="backupFiles" checked>
            <span>ЁЯУБ р╣Др╕Яр╕ер╣Мр╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Ф</span>
          </label>
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="backupConfig" checked>
            <span>тЪЩя╕П р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ъ</span>
          </label>
        </div>
      </div>

      <div class="backup-info" style="background:var(--color-bg);padding:16px;border-radius:8px;margin-top:16px;">
        <div style="font-size:0.9rem;color:var(--color-muted);margin-bottom:8px;">ЁЯУж Backup р╕ер╣Ир╕▓р╕кр╕╕р╕Ф</div>
        <div style="font-weight:500;" id="lastBackupDate">р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е</div>
      </div>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn--secondary" onclick="closeBackupModal()">р╕вр╕Бр╣Ар╕ер╕┤р╕Б</button>
      <button type="button" class="btn btn--primary" onclick="performBackup()">
        <span>ЁЯТ╛</span> р╣Ар╕гр╕┤р╣Ир╕бр╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
      </button>
    </div>
  </div>
</div>

<!-- Reset Database Modal -->
<div id="resetDatabaseModal" class="modal-overlay" style="display:none">
  <div class="modal-content" style="max-width:500px;">
    <div class="modal-header" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white;">
      <h3 style="color: white;">тЪая╕П Reset р╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е</h3>
      <button type="button" class="modal-close" onclick="closeResetDatabaseModal()" style="color: white;">├Ч</button>
    </div>

    <div class="modal-body" style="padding:24px;">
      <div class="danger-warning" style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
          <span style="font-size: 2rem;">ЁЯЪи</span>
          <strong style="color: #dc2626; font-size: 1.1rem;">р╕Др╕│р╣Ар╕Хр╕╖р╕нр╕Щр╕кр╕│р╕Др╕▒р╕Н</strong>
        </div>
        <ul style="margin: 0; padding-left: 20px; color: #7f1d1d;">
          <li>р╕Бр╕▓р╕гр╕Бр╕гр╕░р╕Чр╕│р╕Щр╕╡р╣Йр╕Ир╕░р╕ер╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Гр╕Щр╕гр╕░р╕Ър╕Ъ</li>
          <li>р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕гр╕╡р╕вр╕Бр╕Др╕╖р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Фр╣Йр╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕ер╕Ър╣Бр╕ер╣Йр╕з</li>
          <li>р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З Admin р╣Гр╕лр╕бр╣Ир╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ (admin/admin123)</li>
          <li>р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й, р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ, р╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╕кр╕нр╕Щ р╕Ир╕░р╕Цр╕╣р╕Бр╕ер╕Ър╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф</li>
        </ul>
      </div>

      <div class="verification-section">
        <label class="form-label" style="font-weight: 600; color: #dc2626;">р╕Бр╕гр╕нр╕Бр╕гр╕лр╕▒р╕кр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Фр╣Йр╕▓р╕Щр╕ер╣Ир╕▓р╕З:</label>
        <div id="verificationCode" style="background: #f3f4f6; padding: 12px; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 1.2rem; font-weight: bold; text-align: center; letter-spacing: 4px; margin: 12px 0; color: #1f2937; user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;"></div>
        <input type="text" id="verificationInput" class="form-input" placeholder="р╕Юр╕┤р╕бр╕Юр╣Мр╕гр╕лр╕▒р╕кр╕вр╕╖р╕Щр╕вр╕▒р╕Щ 16 р╕Хр╕▒р╕зр╕нр╕▒р╕Бр╕йр╕г" maxlength="16" autocomplete="off" style="font-family: 'Courier New', monospace; letter-spacing: 2px; text-align: center; font-size: 1.1rem;">
        <small style="color: #6b7280; display: block; margin-top: 8px;">тЪая╕П р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕нр╕Зр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕нр╕З р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Ц Copy-Paste р╣Др╕Фр╣Й</small>
      </div>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn--secondary" onclick="closeResetDatabaseModal()">р╕вр╕Бр╣Ар╕ер╕┤р╕Б</button>
      <button type="button" class="btn btn--danger" onclick="verifyResetDatabase()" style="background: var(--color-danger); color: white;">
        <span>ЁЯЧСя╕П</span> р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕г Reset
      </button>
    </div>
  </div>
</div>

<script src="/js/system.js"></script>